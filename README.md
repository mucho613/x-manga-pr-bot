# x-manga-pr-bot

## 概要
Google Drive の所定のフォルダに保存されている画像とテキストを X に投稿する bot。

## 技術構成
- Google Drive
  - 以下の各種データを格納する
    - bot が投稿する画像とテキスト
    - 投稿がいつ行われるか記述した設定ファイル
- Google Apps Script
  - Google Drive から画像とテキストを読み込む。
  - X API へアクセスして投稿を行う。
  - 管理画面用の Web アプリケーションをホスティングする。

## 機能
### 画像投稿機能
#### 概要
- この機能は、複数の画像とテキストをまとめて X に投稿する。
- 一連の投稿は、X のリプライを使って、起点となる投稿から順に接続された状態になるように行われる。

#### entry の概念
- 一度に投稿したい画像と、投稿に含めるテキストをまとめて entry と呼ぶ。
- entry は、以下の要素から構成される。
  - Image: 1 枚以上の画像
  - Trailing text: 0 〜 X で投稿可能な最大文字数までのテキスト
- 各 entry は Google Drive 上の所定のフォルダに保存されている。
- 予め設定されたスケジュールに沿って、毎日 1 entry ずつ投稿を行う。
- X では、1 投稿あたり最大 4 枚の画像までしか添付できないため、
  - 1 entry に含まれる画像が 4 枚以下の場合は、1 投稿で完結する。
  - 1 entry に含まれる画像が 5 枚以上の場合は、複数投稿に分割して行う。
- 1 entry につき X 上で行われる投稿の数は、投稿する画像の枚数によって変化する。
- さらに、Trailing text は、全ての画像の投稿が完了した後に投稿される。

### 管理画面
- 1日のうち、どの時刻に投稿を行うかを設定できる。設定された内容は、Google Drive 上の設定ファイルへ保存される。
- エラーの発生時（Google Drive へのアクセスエラー、X API から返されたエラーなど）に、その内容を確認できる。